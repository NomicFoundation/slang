#!/bin/bash
set -euo pipefail

source "$(dirname "${BASH_SOURCE[0]}")/../_common.sh"

(
  # We cannot use 'cargo run' to run 'infra_cli', because 'cargo run' sets a bunch of
  # 'CARGO_*' environment variables, and they get propagated to child `cargo` commands
  # that 'infra_cli' spawns. We have to build and run the binary directly to make sure
  # it has a clean environment:

  cargo build --bin "infra_cli"
  "${REPO_ROOT:?}/target/debug/infra_cli" "$@"
)
