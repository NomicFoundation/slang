# yaml-language-server: $schema=../../../../../syntax-schema/syntax/schema/topic.schema.json

- name: ContractDefinition
  sequence:
    - optional:
        terminal: abstract
    - terminal: contract
    - reference: Identifier
    - optional:
        reference: InheritanceSpecifierList
    - terminal: "{"
    - zeroOrMore:
        reference: ContractBodyElement
    - terminal: "}"

- name: InterfaceDefinition
  sequence:
    - terminal: interface
    - reference: Identifier
    - optional:
        reference: InheritanceSpecifierList
    - terminal: "{"
    - zeroOrMore:
        reference: ContractBodyElement
    - terminal: "}"

- name: InheritanceSpecifierList
  sequence:
    - terminal: is
    - oneOrMore:
        reference: InheritanceSpecifier
        separator:
          terminal: ","

- name: InheritanceSpecifier
  sequence:
    - reference: IdentifierPath
    - optional:
        reference: ArgumentList

- name: LibraryDefinition
  sequence:
    - terminal: library
    - reference: Identifier
    - terminal: "{"
    - zeroOrMore:
        reference: ContractBodyElement
    - terminal: "}"

- name: FunctionDefinition
  sequence:
    - terminal: function
    - choice:
        - reference: Identifier
        - terminal: fallback
        - terminal: receive
    - reference: ParameterList
    - zeroOrMore:
        reference: FunctionAttribute
    - optional:
        sequence:
          - terminal: returns
          - reference: NonEmptyParameterList
    - choice:
        - terminal: ;
        - reference: Block

- name: FunctionAttribute
  choice:
    - reference: VisibilitySpecifier
    - reference: StateMutabilitySpecifier
    - reference: ModifierInvocation
    - terminal: virtual
    - reference: OverrideSpecifier

- name: ConstantDefinition
  sequence:
    - reference: TypeName
    - terminal: constant
    - reference: Identifier
    - terminal: "="
    - reference: Expression
    - terminal: ;

- name: StructDefinition
  sequence:
    - terminal: struct
    - reference: Identifier
    - terminal: "{"
    - oneOrMore:
        sequence:
          - reference: TypeName
          - reference: Identifier
          - terminal: ;
    - terminal: "}"

- name: EnumDefinition
  sequence:
    - terminal: enum
    - reference: Identifier
    - terminal: "{"
    - oneOrMore:
        reference: Identifier
        separator:
          terminal: ","
    - terminal: "}"

- name: UserDefinedValueTypeDefinition
  sequence:
    - terminal: type
    - reference: Identifier
    - terminal: is
    - reference: ElementaryTypeWithPayable
    - terminal: ;

- name: EventDefinition
  sequence:
    - terminal: event
    - reference: Identifier
    - terminal: (
    - zeroOrMore:
        reference: EventParameter
        separator:
          terminal: ","
    - terminal: )
    - optional:
        terminal: anonymous
    - terminal: ;

- name: EventParameter
  sequence:
    - reference: TypeName
    - optional:
        terminal: indexed
    - optional:
        reference: Identifier

- name: ErrorDefinition
  sequence:
    - terminal: error
    - reference: Identifier
    - terminal: (
    - zeroOrMore:
        reference: ErrorParameter
        separator:
          terminal: ","
    - terminal: )
    - terminal: ;

- name: ErrorParameter
  sequence:
    - reference: TypeName
    - optional:
        reference: Identifier

- name: ContractBodyElement
  choice:
    - reference: UsingDirective
    - reference: ConstructorDefinition
    - reference: FunctionDefinition
    - reference: FallbackFunctionDefinition
    - reference: ReceiveFunctionDefinition
    - reference: ModifierDefinition
    - reference: StructDefinition
    - reference: EnumDefinition
    - reference: UserDefinedValueTypeDefinition
    - reference: EventDefinition
    - reference: ErrorDefinition
    - reference: StateVariableDeclaration

- name: ConstructorDefinition
  sequence:
    - terminal: constructor
    - reference: ParameterList
    - zeroOrMore:
        reference: ConstructorAttribute
    - reference: Block

- name: ConstructorAttribute
  choice:
    - reference: ModifierInvocation
    - terminal: payable
    - terminal: internal
    - terminal: public

- name: FallbackFunctionDefinition
  sequence:
    - terminal: fallback
    - reference: ParameterList
    - zeroOrMore:
        reference: FallbackFunctionAttribute
    - optional:
        sequence:
          - terminal: returns
          - reference: NonEmptyParameterList
    - choice:
        - terminal: ;
        - reference: Block

- name: FallbackFunctionAttribute
  choice:
    - terminal: external
    - reference: StateMutabilitySpecifier
    - reference: ModifierInvocation
    - terminal: virtual
    - reference: OverrideSpecifier

- name: ReceiveFunctionDefinition
  sequence:
    - terminal: receive
    - terminal: (
    - terminal: )
    - zeroOrMore:
        reference: ReceiveFunctionAttribute
    - choice:
        - terminal: ;
        - reference: Block

- name: ReceiveFunctionAttribute
  choice:
    - terminal: external
    - terminal: payable
    - reference: ModifierInvocation
    - terminal: virtual
    - reference: OverrideSpecifier

- name: ModifierDefinition
  sequence:
    - terminal: modifier
    - reference: Identifier
    - optional:
        reference: ParameterList
    - zeroOrMore:
        reference: MethodAttribute
    - choice:
        - terminal: ;
        - reference: Block

- name: MethodAttribute
  choice:
    - terminal: virtual
    - reference: OverrideSpecifier

- name: StateVariableDeclaration
  sequence:
    - reference: TypeName
    - zeroOrMore:
        reference: StateVariableAttribute
    - reference: Identifier
    - optional:
        sequence:
          - terminal: "="
          - reference: Expression
    - terminal: ;

- name: StateVariableAttribute
  choice:
    - terminal: public
    - terminal: private
    - terminal: internal
    - terminal: constant
    - reference: OverrideSpecifier
    - terminal: immutable

- name: ArgumentList
  sequence:
    - terminal: (
    - optional:
        choice:
          - reference: PositionalArgumentList
          - reference: NamedArgumentList
    - terminal: )

- name: PositionalArgumentList
  oneOrMore:
    reference: Expression
    separator:
      terminal: ","

- name: NamedArgumentList
  sequence:
    - terminal: "{"
    - zeroOrMore:
        reference: NamedArgument
        separator:
          terminal: ","
    - terminal: "}"

- name: NamedArgument
  sequence:
    - reference: Identifier
    - terminal: ":"
    - reference: Expression

- name: ModifierInvocation
  sequence:
    - reference: IdentifierPath
    - optional:
        reference: ArgumentList

- name: ParameterList
  sequence:
    - terminal: (
    - zeroOrMore:
        reference: ParameterDeclaration
        separator:
          terminal: ","
    - terminal: )

- name: NonEmptyParameterList
  sequence:
    - terminal: (
    - oneOrMore:
        reference: ParameterDeclaration
        separator:
          terminal: ","
    - terminal: )

- name: ParameterDeclaration
  sequence:
    - reference: TypeName
    - optional:
        reference: DataLocation
    - optional:
        reference: Identifier

- name: VisibilitySpecifier
  choice:
    - terminal: internal
    - terminal: external
    - terminal: private
    - terminal: public

- name: StateMutabilitySpecifier
  choice:
    - terminal: pure
    - terminal: view
    - terminal: payable

- name: OverrideSpecifier
  sequence:
    - terminal: override
    - optional:
        sequence:
          - terminal: (
          - repeat:
              min: 1
              max: 1
              reference: IdentifierPath
              separator:
                terminal: ","
          - terminal: )

- name: IdentifierPath
  oneOrMore:
    reference: Identifier
    separator:
      terminal: "."

- name: TypeName
  sequence:
    - choice:
        - reference: ElementaryTypeWithPayable
        - reference: FunctionType
        - reference: MappingType
        - reference: IdentifierPath
    - zeroOrMore:
        sequence:
          - terminal: "["
          - optional:
              reference: Expression
          - terminal: "]"

- name: ElementaryTypeWithPayable
  choice:
    - sequence:
        - terminal: address
        - optional:
            terminal: payable
    - reference: ElementaryType

- name: ElementaryTypeWithoutPayable
  choice:
    - terminal: address
    - reference: ElementaryType

- name: ElementaryType
  choice:
    - terminal: bool
    - terminal: string
    - terminal: bytes
    - reference: SignedIntegerType
    - reference: UnsignedIntegerType
    - reference: FixedBytesType
    - reference: FixedType
    - reference: UfixedType

- name: FunctionType
  sequence:
    - terminal: function
    - reference: ParameterList
    - zeroOrMore:
        choice:
          - reference: VisibilitySpecifier
          - reference: StateMutabilitySpecifier
    - optional:
        sequence:
          - terminal: returns
          - reference: NonEmptyParameterList

- name: MappingType
  sequence:
    - terminal: mapping
    - terminal: (
    - choice:
        - reference: ElementaryTypeWithoutPayable
        - reference: IdentifierPath
    - terminal: "=>"
    - reference: TypeName
    - terminal: )

- name: DataLocation
  choice:
    - terminal: memory
    - terminal: storage
    - terminal: calldata

- name: Expression
  reference: AssignmentExpression

- name: AssignmentExpression
  sequence:
    - reference: ConditionalExpression
    - zeroOrMore:
        sequence:
          - reference: AssignmentOperator
          - reference: Expression

- name: AssignmentOperator
  choice:
    - terminal: "="
    - terminal: "|="
    - terminal: ^=
    - terminal: "&="
    - terminal: "<<="
    - terminal: ">>="
    - terminal: ">>>="
    - terminal: +=
    - terminal: "-="
    - terminal: "*="
    - terminal: /=
    - terminal: "%="

- name: ConditionalExpression
  sequence:
    - reference: OrExpression
    - optional:
        sequence:
          - terminal: "?"
          - reference: Expression
          - terminal: ":"
          - reference: Expression

- name: OrExpression
  sequence:
    - reference: AndExpression
    - zeroOrMore:
        sequence:
          - terminal: "||"
          - reference: AndExpression

- name: AndExpression
  sequence:
    - reference: EqualityComparisonExpression
    - zeroOrMore:
        sequence:
          - terminal: "&&"
          - reference: EqualityComparisonExpression

- name: EqualityComparisonExpression
  sequence:
    - reference: OrderComparisonExpression
    - zeroOrMore:
        sequence:
          - reference: EqualityComparisonOperator
          - reference: OrderComparisonExpression

- name: EqualityComparisonOperator
  choice:
    - terminal: "=="
    - terminal: "!="

- name: OrderComparisonExpression
  sequence:
    - reference: BitOrExpression
    - zeroOrMore:
        sequence:
          - reference: OrderComparisonOperator
          - reference: BitOrExpression

- name: OrderComparisonOperator
  choice:
    - terminal: "<"
    - terminal: ">"
    - terminal: "<="
    - terminal: ">="

- name: BitOrExpression
  sequence:
    - reference: BitXOrExpression
    - zeroOrMore:
        sequence:
          - terminal: "|"
          - reference: BitXOrExpression

- name: BitXOrExpression
  sequence:
    - reference: BitAndExpression
    - zeroOrMore:
        sequence:
          - terminal: ^
          - reference: BitAndExpression

- name: BitAndExpression
  sequence:
    - reference: ShiftExpression
    - zeroOrMore:
        sequence:
          - terminal: "&"
          - reference: ShiftExpression

- name: ShiftExpression
  sequence:
    - reference: AddSubExpression
    - zeroOrMore:
        sequence:
          - reference: ShiftOperator
          - reference: AddSubExpression

- name: ShiftOperator
  choice:
    - terminal: "<<"
    - terminal: ">>"
    - terminal: ">>>"

- name: AddSubExpression
  sequence:
    - reference: MulDivModExpression
    - zeroOrMore:
        sequence:
          - reference: AddSubOperator
          - reference: MulDivModExpression

- name: AddSubOperator
  choice:
    - terminal: +
    - terminal: "-"

- name: MulDivModExpression
  sequence:
    - reference: ExpExpression
    - zeroOrMore:
        sequence:
          - reference: MulDivModOperator
          - reference: ExpExpression

- name: MulDivModOperator
  choice:
    - terminal: "*"
    - terminal: /
    - terminal: "%"

- name: ExpExpression
  sequence:
    - reference: UnarySuffixExpression
    - zeroOrMore:
        sequence:
          - terminal: "**"
          - reference: Expression

- name: UnarySuffixExpression
  sequence:
    - reference: UnaryPrefixExpression
    - optional:
        reference: UnarySuffixOperator

- name: UnarySuffixOperator
  choice:
    - terminal: ++
    - terminal: "--"

- name: UnaryPrefixExpression
  sequence:
    - optional:
        reference: UnaryPrefixOperator
    - reference: FunctionCallExpression

- name: UnaryPrefixOperator
  choice:
    - terminal: ++
    - terminal: "--"
    - terminal: "!"
    - terminal: "~"
    - terminal: delete
    - terminal: "-"

- name: FunctionCallExpression
  sequence:
    - reference: FunctionCallOptionsExpression
    - zeroOrMore:
        reference: ArgumentList

- name: FunctionCallOptionsExpression
  sequence:
    - reference: MemberAccessExpression
    - zeroOrMore:
        sequence:
          - terminal: "{"
          - oneOrMore:
              reference: NamedArgument
              separator:
                terminal: ","
          - terminal: "}"

- name: MemberAccessExpression
  sequence:
    - reference: IndexAccessExpression
    - zeroOrMore:
        sequence:
          - terminal: "."
          - choice:
              - reference: Identifier
              - terminal: address

- name: IndexAccessExpression
  sequence:
    - reference: PrimaryExpression
    - zeroOrMore:
        sequence:
          - terminal: "["
          - optional:
              reference: Expression
          - optional:
              sequence:
                - terminal: ":"
                - optional:
                    reference: Expression
          - terminal: "]"

- name: PrimaryExpression
  choice:
    - sequence:
        - terminal: payable
        - reference: ArgumentList
    - sequence:
        - terminal: type
        - terminal: (
        - reference: TypeName
        - terminal: )
    - sequence:
        - terminal: new
        - reference: TypeName
    - sequence:
        - terminal: (
        - oneOrMore:
            optional:
              reference: Expression
            separator:
              terminal: ","
        - terminal: )
    - sequence:
        - terminal: "["
        - oneOrMore:
            reference: Expression
            separator:
              terminal: ","
        - terminal: "]"
    - reference: Identifier
    - reference: Literal
    - reference: ElementaryTypeWithoutPayable

- name: Literal
  choice:
    - reference: AsciiStringLiteral
    - reference: UnicodeStringLiteral
    - reference: NumericLiteral
    - reference: HexStringLiteral
    - reference: BooleanLiteral

- name: NumericLiteral
  sequence:
    - choice:
        - reference: DecimalNumber
        - reference: HexNumber
    - optional:
        reference: NumberUnit

- name: Block
  sequence:
    - terminal: "{"
    - zeroOrMore:
        choice:
          - reference: Statement
          - reference: UncheckedBlock
    - terminal: "}"

- name: UncheckedBlock
  sequence:
    - terminal: unchecked
    - reference: Block

- name: Statement
  choice:
    - reference: Block
    - reference: SimpleStatement
    - reference: IfStatement
    - reference: ForStatement
    - reference: WhileStatement
    - reference: DoWhileStatement
    - reference: ContinueStatement
    - reference: BreakStatement
    - reference: TryStatement
    - reference: ReturnStatement
    - reference: EmitStatement
    - reference: RevertStatement
    - reference: AssemblyStatement

- name: SimpleStatement
  choice:
    - reference: VariableDeclarationStatement
    - reference: ExpressionStatement

- name: IfStatement
  sequence:
    - terminal: if
    - terminal: (
    - reference: Expression
    - terminal: )
    - reference: Statement
    - optional:
        sequence:
          - terminal: else
          - reference: Statement

- name: ForStatement
  sequence:
    - terminal: for
    - terminal: (
    - choice:
        - reference: SimpleStatement
        - terminal: ;
    - choice:
        - reference: ExpressionStatement
        - terminal: ;
    - optional:
        reference: Expression
    - terminal: )
    - reference: Statement

- name: WhileStatement
  sequence:
    - terminal: while
    - terminal: (
    - reference: Expression
    - terminal: )
    - reference: Statement

- name: DoWhileStatement
  sequence:
    - terminal: do
    - reference: Statement
    - terminal: while
    - terminal: (
    - reference: Expression
    - terminal: )
    - terminal: ;

- name: ContinueStatement
  sequence:
    - terminal: continue
    - terminal: ;

- name: BreakStatement
  sequence:
    - terminal: break
    - terminal: ;

- name: TryStatement
  sequence:
    - terminal: try
    - reference: Expression
    - optional:
        sequence:
          - terminal: returns
          - reference: NonEmptyParameterList
    - reference: Block
    - reference: CatchClause
    - zeroOrMore:
        reference: CatchClause

- name: CatchClause
  sequence:
    - terminal: catch
    - optional:
        sequence:
          - optional:
              reference: Identifier
          - reference: NonEmptyParameterList
    - reference: Block

- name: ReturnStatement
  sequence:
    - terminal: return
    - optional:
        reference: Expression
    - terminal: ;

- name: EmitStatement
  sequence:
    - terminal: emit
    - reference: Expression
    - reference: ArgumentList
    - terminal: ;

- name: RevertStatement
  sequence:
    - terminal: revert
    - reference: Expression
    - reference: ArgumentList
    - terminal: ;

- name: VariableDeclarationList
  oneOrMore:
    reference: VariableDeclaration
    separator:
      terminal: ","

- name: VariableDeclarationTuple
  sequence:
    - terminal: (
    - zeroOrMore:
        terminal: ","
    - reference: VariableDeclaration
    - zeroOrMore:
        sequence:
          - terminal: ","
          - optional:
              reference: VariableDeclaration
    - terminal: )

- name: VariableDeclarationStatement
  sequence:
    - choice:
        - sequence:
            - reference: VariableDeclaration
            - optional:
                sequence:
                  - terminal: "="
                  - reference: Expression
        - sequence:
            - reference: VariableDeclarationTuple
            - terminal: "="
            - reference: Expression
    - terminal: ;

- name: VariableDeclaration
  sequence:
    - reference: TypeName
    - optional:
        reference: DataLocation
    - reference: Identifier

- name: ExpressionStatement
  sequence:
    - reference: Expression
    - terminal: ;

- name: AssemblyStatement
  sequence:
    - terminal: assembly
    - optional:
        terminal: '"evmasm"'
    - optional:
        reference: AssemblyFlags
    - reference: YulBlock

- name: AssemblyFlags
  sequence:
    - terminal: (
    - oneOrMore:
        reference: DoubleQuotedAsciiStringLiteral
        separator:
          terminal: ","
    - terminal: )

- name: Identifier
  isToken: true
  difference:
    minuend:
      reference: RawIdentifier
    subtrahend:
      reference: ReservedWord

- name: ReservedWord
  isToken: true
  choice:
    - reference: Keyword
    - reference: ReservedKeyword
    - reference: NumberUnit
    - reference: BooleanLiteral

- name: Keyword
  isToken: true
  choice:
    - terminal: pragma
    - terminal: abstract
    - terminal: anonymous
    - terminal: address
    - terminal: as
    - terminal: assembly
    - terminal: bool
    - terminal: break
    - terminal: bytes
    - terminal: calldata
    - terminal: catch
    - terminal: constant
    - terminal: constructor
    - terminal: continue
    - terminal: contract
    - terminal: delete
    - terminal: do
    - terminal: else
    - terminal: emit
    - terminal: enum
    - terminal: event
    - terminal: external
    - terminal: fallback
    - terminal: "false"
    - terminal: for
    - terminal: function
    - terminal: hex
    - terminal: if
    - terminal: immutable
    - terminal: import
    - terminal: indexed
    - terminal: interface
    - terminal: internal
    - terminal: is
    - terminal: library
    - terminal: mapping
    - terminal: memory
    - terminal: modifier
    - terminal: new
    - terminal: override
    - terminal: payable
    - terminal: private
    - terminal: public
    - terminal: pure
    - terminal: receive
    - terminal: return
    - terminal: returns
    - terminal: storage
    - terminal: string
    - terminal: struct
    - terminal: "true"
    - terminal: try
    - terminal: type
    - terminal: unchecked
    - terminal: using
    - terminal: view
    - terminal: virtual
    - terminal: while
    - reference: SignedIntegerType
    - reference: UnsignedIntegerType
    - reference: FixedBytesType
    - terminal: fixed
    - terminal: ufixed

- name: ReservedKeyword
  isToken: true
  choice:
    - terminal: after
    - terminal: alias
    - terminal: apply
    - terminal: auto
    - terminal: byte
    - terminal: case
    - terminal: copyof
    - terminal: default
    - terminal: define
    - terminal: final
    - terminal: implements
    - terminal: in
    - terminal: inline
    - terminal: let
    - terminal: macro
    - terminal: match
    - terminal: mutable
    - terminal: "null"
    - terminal: of
    - terminal: partial
    - terminal: promise
    - terminal: reference
    - terminal: relocatable
    - terminal: sealed
    - terminal: sizeof
    - terminal: static
    - terminal: supports
    - terminal: switch
    - terminal: typedef
    - terminal: typeof
    - terminal: var

- name: PragmaDirective
  isToken: true
  sequence:
    - terminal: pragma
    - not:
        terminal: ;
    - zeroOrMore:
        not:
          terminal: ;
        config: { name: NonSemicolonChar }
    - terminal: ;

- name: RawIdentifier
  isToken: true
  sequence:
    - reference: IdentifierStart
    - zeroOrMore:
        reference: IdentifierPart

- name: IdentifierStart
  isToken: true
  choice:
    - terminal: _
    - terminal: $
    - range:
        from: a
        to: z
    - range:
        from: A
        to: Z

- name: IdentifierPart
  isToken: true
  choice:
    - reference: IdentifierStart
    - range:
        from: "0"
        to: "9"

- name: SignedIntegerType
  isToken: true
  sequence:
    - terminal: int
    - choice:
        - terminal: "8"
        - terminal: "16"
        - terminal: "24"
        - terminal: "32"
        - terminal: "40"
        - terminal: "48"
        - terminal: "56"
        - terminal: "64"
        - terminal: "72"
        - terminal: "80"
        - terminal: "88"
        - terminal: "96"
        - terminal: "104"
        - terminal: "112"
        - terminal: "120"
        - terminal: "128"
        - terminal: "136"
        - terminal: "144"
        - terminal: "152"
        - terminal: "160"
        - terminal: "168"
        - terminal: "176"
        - terminal: "184"
        - terminal: "192"
        - terminal: "200"
        - terminal: "208"
        - terminal: "216"
        - terminal: "224"
        - terminal: "232"
        - terminal: "240"
        - terminal: "248"
        - terminal: "256"
      config:
        # Makes the likely errors clearer?
        lookahead: { not: { range: { from: "0", to: "9" } } }

- name: UnsignedIntegerType
  isToken: true
  sequence:
    - terminal: u
    - reference: SignedIntegerType

- name: FixedBytesType
  isToken: true
  sequence:
    - terminal: bytes
    - choice:
        - terminal: "1"
        - terminal: "2"
        - terminal: "3"
        - terminal: "4"
        - terminal: "5"
        - terminal: "6"
        - terminal: "7"
        - terminal: "8"
        - terminal: "9"
        - terminal: "10"
        - terminal: "11"
        - terminal: "12"
        - terminal: "13"
        - terminal: "14"
        - terminal: "15"
        - terminal: "16"
        - terminal: "17"
        - terminal: "18"
        - terminal: "19"
        - terminal: "20"
        - terminal: "21"
        - terminal: "22"
        - terminal: "23"
        - terminal: "24"
        - terminal: "25"
        - terminal: "26"
        - terminal: "27"
        - terminal: "28"
        - terminal: "29"
        - terminal: "30"
        - terminal: "31"
        - terminal: "32"
      config:
        # Makes the likely errors clearer?
        lookahead: { not: { range: { from: "0", to: "9" } } }

- name: FixedType
  isToken: true
  sequence:
    - terminal: fixed
    - optional:
        sequence:
          - range:
              from: "1"
              to: "9"
          - zeroOrMore:
              range:
                from: "0"
                to: "9"
          - terminal: x
          - range:
              from: "1"
              to: "9"
          - zeroOrMore:
              range:
                from: "0"
                to: "9"

- name: UfixedType
  isToken: true
  sequence:
    - terminal: u
    - reference: FixedType

- name: BooleanLiteral
  isToken: true
  choice:
    - terminal: "true"
    - terminal: "false"

- name: DecimalNumber
  isToken: true
  sequence:
    - choice:
        - reference: DecimalInteger
        - reference: DecimalFloat
    - optional:
        reference: DecimalExponent

- name: DecimalInteger
  isToken: true
  oneOrMore:
    range:
      from: "0"
      to: "9"
    separator:
      optional:
        terminal: _

- name: DecimalFloat
  isToken: true
  sequence:
    - optional:
        reference: DecimalInteger
    - terminal: "."
    - reference: DecimalInteger

- name: DecimalExponent
  isToken: true
  sequence:
    - choice:
        - terminal: e
        - terminal: E
    - optional:
        terminal: "-"
    - reference: DecimalInteger

- name: HexNumber
  isToken: true
  sequence:
    - terminal: "0"
    - terminal: x
    - oneOrMore:
        reference: HexCharacter
        separator:
          optional:
            terminal: _

- name: NumberUnit
  isToken: true
  choice:
    - terminal: wei
    - terminal: gwei
    - terminal: ether
    - terminal: seconds
    - terminal: minutes
    - terminal: hours
    - terminal: days
    - terminal: weeks
    - terminal: years

- name: HexStringLiteral
  isToken: true
  sequence:
    - terminal: hex
    - choice:
        - sequence:
            - terminal: '"'
            - optional:
                reference: PossiblySeparatedPairsOfHexDigits
            - terminal: '"'
        - sequence:
            - terminal: "'"
            - optional:
                reference: PossiblySeparatedPairsOfHexDigits
            - terminal: "'"

- name: PossiblySeparatedPairsOfHexDigits
  isToken: true
  oneOrMore:
    repeat:
      min: 2
      max: 2
      reference: HexCharacter
    separator:
      optional:
        terminal: _

- name: HexCharacter
  isToken: true
  choice:
    - range:
        from: "0"
        to: "9"
    - range:
        from: a
        to: f
    - range:
        from: A
        to: F

- name: AsciiStringLiteral
  isToken: true
  choice:
    - reference: SingleQuotedAsciiStringLiteral
    - reference: DoubleQuotedAsciiStringLiteral

- name: SingleQuotedAsciiStringLiteral
  isToken: true
  sequence:
    - terminal: "'"
    - zeroOrMore:
        choice:
          - difference:
              minuend:
                range:
                  from: " "
                  to: "~"
              subtrahend:
                choice:
                  - terminal: "'"
                  - terminal: "\\"
          - reference: EscapeSequence
    - terminal: "'"

- name: DoubleQuotedAsciiStringLiteral
  isToken: true
  sequence:
    - terminal: '"'
    - zeroOrMore:
        choice:
          - difference:
              minuend:
                range:
                  from: " "
                  to: "~"
              subtrahend:
                choice:
                  - terminal: '"'
                  - terminal: "\\"
          - reference: EscapeSequence
    - terminal: '"'

- name: UnicodeStringLiteral
  isToken: true
  choice:
    - reference: SingleQuotedUnicodeStringLiteral
    - reference: DoubleQuotedUnicodeStringLiteral

- name: SingleQuotedUnicodeStringLiteral
  isToken: true
  sequence:
    - terminal: "unicode'"
    - zeroOrMore:
        choice:
          - not:
              choice:
                - terminal: "'"
                - terminal: "\\"
                - terminal: "\n"
                - terminal: "\r"
          - reference: EscapeSequence
    - terminal: "'"

- name: DoubleQuotedUnicodeStringLiteral
  isToken: true
  sequence:
    - terminal: 'unicode"'
    - zeroOrMore:
        choice:
          - not:
              choice:
                - terminal: '"'
                - terminal: "\\"
                - terminal: "\n"
                - terminal: "\r"
          - reference: EscapeSequence
    - terminal: '"'

- name: EscapeSequence
  isToken: true
  sequence:
    - terminal: "\\"
    - choice:
        - reference: AsciiEscape
        - reference: HexByteEscape
        - reference: UnicodeEscape

- name: AsciiEscape
  isToken: true
  choice:
    - terminal: n
    - terminal: r
    - terminal: t
    - terminal: "'"
    - terminal: '"'
    - terminal: "\\"
    - terminal: "\n"
    - terminal: "\r"

- name: HexByteEscape
  isToken: true
  sequence:
    - terminal: x
    - repeat:
        min: 2
        max: 2
        reference: HexCharacter

- name: UnicodeEscape
  isToken: true
  sequence:
    - terminal: u
    - repeat:
        min: 4
        max: 4
        reference: HexCharacter

- name: YulBlock
  sequence:
    - terminal: "{"
    - zeroOrMore:
        reference: YulStatement
    - terminal: "}"

- name: YulStatement
  choice:
    - reference: YulBlock
    - reference: YulVariableDeclaration
    - reference: YulFunctionDefinition
    - reference: YulAssignment
    - reference: YulFunctionCall
    - reference: YulIfStatement
    - reference: YulForStatement
    - reference: YulSwitchStatement
    - reference: YulLeaveStatement
    - reference: YulBreakStatement
    - reference: YulContinueStatement

- name: YulVariableDeclaration
  sequence:
    - terminal: let
    - reference: YulIdentifier
    - optional:
        choice:
          - sequence:
              - terminal: ":="
              - reference: YulExpression
          - sequence:
              - optional:
                  sequence:
                    - terminal: ","
                    - reference: YulIdentifier
              - optional:
                  sequence:
                    - terminal: ":="
                    - reference: YulFunctionCall

- name: YulFunctionDefinition
  sequence:
    - terminal: function
    - reference: YulIdentifier
    - terminal: (
    - zeroOrMore:
        reference: YulIdentifier
        separator:
          terminal: ","
    - terminal: )
    - optional:
        sequence:
          - terminal: "->"
          - oneOrMore:
              reference: YulIdentifier
              separator:
                terminal: ","
    - reference: YulBlock

- name: YulAssignment
  sequence:
    - reference: YulPath
    - choice:
        - sequence:
            - terminal: ":="
            - reference: YulExpression
        - sequence:
            - oneOrMore:
                sequence:
                  - terminal: ","
                  - reference: YulPath
            - terminal: ":="
            - reference: YulFunctionCall

- name: YulFunctionCall
  sequence:
    - choice:
        - reference: YulIdentifier
        - reference: YulEVMBuiltinFunctionName
    - terminal: (
    - zeroOrMore:
        reference: YulExpression
        separator:
          terminal: ","
    - terminal: )

- name: YulIfStatement
  sequence:
    - terminal: if
    - reference: YulExpression
    - reference: YulBlock

- name: YulLeaveStatement
  terminal: leave

- name: YulBreakStatement
  terminal: break

- name: YulContinueStatement
  terminal: continue

- name: YulForStatement
  sequence:
    - terminal: for
    - reference: YulBlock
    - reference: YulExpression
    - reference: YulBlock
    - reference: YulBlock

- name: YulSwitchStatement
  sequence:
    - terminal: switch
    - reference: YulExpression
    - choice:
        - sequence:
            - oneOrMore:
                sequence:
                  - terminal: case
                  - reference: YulLiteral
                  - reference: YulBlock
            - optional:
                sequence:
                  - terminal: default
                  - reference: YulBlock
        - sequence:
            - terminal: default
            - reference: YulBlock

- name: YulExpression
  choice:
    - reference: YulPath
    - reference: YulFunctionCall
    - reference: YulLiteral

- name: YulPath
  sequence:
    - reference: YulIdentifier
    - zeroOrMore:
        sequence:
          - terminal: "."
          - choice:
              - reference: YulIdentifier
              - reference: YulEVMBuiltinFunctionName

- name: YulLiteral
  choice:
    - reference: YulDecimalNumberLiteral
    - reference: YulHexLiteral
    - reference: AsciiStringLiteral
    - reference: BooleanLiteral
    - reference: HexStringLiteral

- name: YulIdentifier
  isToken: true
  difference:
    minuend:
      reference: RawIdentifier
    subtrahend:
      reference: YulReservedWord

- name: YulReservedWord
  isToken: true
  choice:
    - reference: YulKeyword
    - reference: YulEVMBuiltinFunctionName
    - reference: BooleanLiteral

- name: YulKeyword
  isToken: true
  choice:
    - terminal: break
    - terminal: case
    - terminal: continue
    - terminal: default
    - terminal: for
    - terminal: function
    - terminal: if
    - terminal: leave
    - terminal: let
    - terminal: switch
    - terminal: hex

- name: YulEVMBuiltinFunctionName
  isToken: true
  choice:
    - terminal: stop
    - terminal: add
    - terminal: sub
    - terminal: mul
    - terminal: div
    - terminal: sdiv
    - terminal: mod
    - terminal: smod
    - terminal: exp
    - terminal: not
    - terminal: lt
    - terminal: gt
    - terminal: slt
    - terminal: sgt
    - terminal: eq
    - terminal: iszero
    - terminal: and
    - terminal: or
    - terminal: xor
    - terminal: byte
    - terminal: shl
    - terminal: shr
    - terminal: sar
    - terminal: addmod
    - terminal: mulmod
    - terminal: signextend
    - terminal: keccak256
    - terminal: pop
    - terminal: mload
    - terminal: mstore
    - terminal: mstore8
    - terminal: sload
    - terminal: sstore
    - terminal: msize
    - terminal: gas
    - terminal: address
    - terminal: balance
    - terminal: selfbalance
    - terminal: caller
    - terminal: callvalue
    - terminal: calldataload
    - terminal: calldatasize
    - terminal: calldatacopy
    - terminal: extcodesize
    - terminal: extcodecopy
    - terminal: returndatasize
    - terminal: returndatacopy
    - terminal: extcodehash
    - terminal: create
    - terminal: create2
    - terminal: call
    - terminal: callcode
    - terminal: delegatecall
    - terminal: staticcall
    - terminal: return
    - terminal: revert
    - terminal: selfdestruct
    - terminal: invalid
    - terminal: log0
    - terminal: log1
    - terminal: log2
    - terminal: log3
    - terminal: log4
    - terminal: chainid
    - terminal: origin
    - terminal: gasprice
    - terminal: Blockhash
    - terminal: coinbase
    - terminal: timestamp
    - terminal: number
    - terminal: difficulty
    - terminal: gaslimit
    - terminal: basefee

- name: YulDecimalNumberLiteral
  isToken: true
  choice:
    - terminal: "0"
    - sequence:
        - range:
            from: "1"
            to: "9"
        - zeroOrMore:
            range:
              from: "0"
              to: "9"

- name: YulHexLiteral
  isToken: true
  sequence:
    - terminal: "0x"
    - choice:
        - range:
            from: "0"
            to: "9"
        - range:
            from: a
            to: f
        - range:
            from: A
            to: F
    - zeroOrMore:
        choice:
          - range:
              from: "0"
              to: "9"
          - range:
              from: a
              to: f
          - range:
              from: A
              to: F
