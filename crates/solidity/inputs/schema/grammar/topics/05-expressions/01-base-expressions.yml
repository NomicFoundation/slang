# yaml-language-server: $schema=../../../../../../codegen/schema/generated/topic.schema.json

- name: "Expression"
  kind: "Rule"
  versioned:
    0.4.11:
      parserType: "Precedence"
      choice:
        - reference: "AssignmentExpression"
        - reference: "ConditionalExpression"
        - reference: "OrExpression"
        - reference: "AndExpression"
        - reference: "EqualityComparisonExpression"
        - reference: "OrderComparisonExpression"
        - reference: "BitOrExpression"
        - reference: "BitXOrExpression"
        - reference: "BitAndExpression"
        - reference: "ShiftExpression"
        - reference: "AddSubExpression"
        - reference: "MulDivModExpression"
        - reference: "ExponentiationExpression"
        - reference: "UnarySuffixExpression"
        - reference: "UnaryPrefixExpression"
        - reference: "FunctionCallExpression"
        - reference: "MemberAccessExpression"
        - reference: "IndexAccessExpression"
        - reference: "PrimaryExpression"
    0.6.0:
      parserType: "Precedence"
      choice:
        - reference: "AssignmentExpression"
        - reference: "ConditionalExpression"
        - reference: "OrExpression"
        - reference: "AndExpression"
        - reference: "EqualityComparisonExpression"
        - reference: "OrderComparisonExpression"
        - reference: "BitOrExpression"
        - reference: "BitXOrExpression"
        - reference: "BitAndExpression"
        - reference: "ShiftExpression"
        - reference: "AddSubExpression"
        - reference: "MulDivModExpression"
        - reference: "ExponentiationExpression"
        - reference: "UnarySuffixExpression"
        - reference: "UnaryPrefixExpression"
        - reference: "FunctionCallExpression"
        - reference: "MemberAccessExpression"
        - reference: "IndexAccessExpression"
        - reference: "PrimaryExpression"

- name: "AssignmentExpression"
  kind: "Rule"
  unversioned:
    associativity: "Left"
    sequence:
      - reference: "Expression"
      - choice:
          - terminal: "="
          - terminal: "|="
          - terminal: "^="
          - terminal: "&="
          - terminal: "<<="
          - terminal: ">>="
          - terminal: ">>>="
          - terminal: "+="
          - terminal: "-="
          - terminal: "*="
          - terminal: "/="
          - terminal: "%="
      - reference: "Expression"

- name: "ConditionalExpression"
  kind: "Rule"
  unversioned:
    sequence:
      - reference: "Expression"
      - sequence: # This subsequence forms the correct CST for the suffix expression parser
          - terminal: "?"
          - reference: "Expression"
          - terminal: ":"
          - reference: "Expression"

- name: "FunctionCallExpression"
  kind: "Rule"
  unversioned:
    sequence:
      - reference: "Expression"
      - optional:
          reference: "NamedArgumentList"
      - reference: "ArgumentList"

- name: "MemberAccessExpression"
  kind: "Rule"
  unversioned:
    sequence:
      - reference: "Expression"
      - terminal: "."
      - choice:
          - reference: "Identifier"
          - terminal: "address"

- name: "IndexAccessExpression"
  kind: "Rule"
  unversioned:
    associativity: "Left"
    sequence:
      - reference: "Expression"
      - delimitedBy:
          open: "["
          expression:
            sequence:
              - optional:
                  reference: "Expression"
              - optional:
                  sequence:
                    - terminal: ":"
                    - optional:
                        reference: "Expression"
          close: "]"
